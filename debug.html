<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug CRGM-API</title>
    <style>
        body { background: #000; color: #0f0; font-family: monospace; padding: 20px; }
        .success { color: #0f0; }
        .error { color: #f00; }
        .warning { color: #ff0; }
        pre { background: #111; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üîç Diagn√≥stico CRGM-API</h1>
    <div id="results"></div>
    
    <script type="module">
        const results = document.getElementById('results');
        
        function log(message, type = 'success') {
            const p = document.createElement('p');
            p.className = type;
            p.textContent = message;
            results.appendChild(p);
        }
        
        async function runDiagnostics() {
            log('=== INICIANDO DIAGN√ìSTICOS ===', 'warning');
            
            // Test 1: Imports
            try {
                log('‚úì Intentando importar DatabaseManager...');
                const { default: DatabaseManager } = await import('./js/core/database.js');
                log('‚úì DatabaseManager importado correctamente');
                log(`  - Nombre: ${DatabaseManager.name}`);
                log(`  - Versi√≥n: ${DatabaseManager.version}`);
                
                log('‚úì Intentando importar AuthManager...');
                const { default: AuthManager } = await import('./js/core/auth.js');
                log('‚úì AuthManager importado correctamente');
                log(`  - Nombre: ${AuthManager.name}`);
                log(`  - Versi√≥n: ${AuthManager.version}`);
                
                log('‚úì Intentando importar ModuleManager...');
                const { default: ModuleManager } = await import('./js/core/modules.js');
                log('‚úì ModuleManager importado correctamente');
                log(`  - Nombre: ${ModuleManager.name}`);
                log(`  - Versi√≥n: ${ModuleManager.version}`);
                
                // Test 2: Inicializaci√≥n
                log('\\n=== PROBANDO INICIALIZACI√ìN ===', 'warning');
                
                log('‚úì Inicializando DatabaseManager...');
                await DatabaseManager.init();
                log('‚úì DatabaseManager inicializado');
                
                log('‚úì Inicializando AuthManager...');
                await AuthManager.init();
                log('‚úì AuthManager inicializado');
                
                log('‚úì Inicializando ModuleManager...');
                await ModuleManager.init();
                log('‚úì ModuleManager inicializado');
                
                log('\\n=== RESULTADO ===', 'warning');
                log('üéâ TODOS LOS M√ìDULOS FUNCIONAN CORRECTAMENTE', 'success');
                log('\\nEl problema debe estar en otro lado. Verifica:', 'warning');
                log('1. ¬øEst√°s en http://localhost:8000 (no file://)?');
                log('2. ¬øLimpiaste el cach√© (Ctrl+Shift+R)?');
                log('3. Abre la consola (F12) en index.html y copia los errores rojos aqu√≠');
                
            } catch (error) {
                log('\\n‚úó ERROR ENCONTRADO:', 'error');
                log(`Tipo: ${error.name}`, 'error');
                log(`Mensaje: ${error.message}`, 'error');
                log(`Stack:`, 'error');
                const pre = document.createElement('pre');
                pre.className = 'error';
                pre.textContent = error.stack || 'No stack trace';
                results.appendChild(pre);
                
                log('\\nüîß POSIBLES SOLUCIONES:', 'warning');
                if (error.message.includes('Failed to fetch')) {
                    log('- El servidor no est√° corriendo o est√° en el directorio equivocado', 'warning');
                    log('- Ejecuta: cd /home/crgm-unix/Desktop/CRGM-API && ./iniciar.sh', 'warning');
                } else if (error.message.includes('import')) {
                    log('- Problema con rutas de archivos', 'warning');
                    log('- Verifica que est√©s en http://localhost:8000', 'warning');
                }
            }
        }
        
        runDiagnostics();
    </script>
</body>
</html>
